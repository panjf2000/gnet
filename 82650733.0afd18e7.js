(window.webpackJsonp=window.webpackJsonp||[]).push([[50],{194:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return r})),n.d(t,"metadata",(function(){return c})),n.d(t,"rightToc",(function(){return l})),n.d(t,"default",(function(){return s}));var a=n(1),o=n(9),i=(n(0),n(246)),r={id:"doc-for-gnet-v1",last_modified_on:"2022-02-26",title:"Doc for gnet v1",description:"Hello World! We present you, gnet!",author_github:"https://github.com/panjf2000",tags:["type: announcement","domain: presentation"]},c={id:"v1.x/doc-for-gnet-v1",title:"Doc for gnet v1",description:"Hello World! We present you, gnet!",source:"@site/docs/v1.x/doc-for-gnet-v1.md",permalink:"/docs/v1.x/doc-for-gnet-v1",editUrl:"https://github.com/panjf2000/gnet/edit/master/website/docs/v1.x/doc-for-gnet-v1.md",sidebar:"docs",previous:{title:"Benchmark",permalink:"/docs/benchmark"},next:{title:"gnet v1 \u6587\u6863",permalink:"/docs/v1.x/doc-for-gnet-v1-cn"}},l=[{value:"Prerequisites",id:"prerequisites",children:[]},{value:"Installation",id:"installation",children:[]},{value:"Usage Examples",id:"usage-examples",children:[{value:"Echo server without blocking logic",id:"echo-server-without-blocking-logic",children:[]},{value:"Echo server with blocking logic",id:"echo-server-with-blocking-logic",children:[]}]},{value:"I/O Events",id:"io-events",children:[]},{value:"poll_opt mode",id:"poll_opt-mode",children:[]},{value:"Ticker",id:"ticker",children:[]},{value:"UDP",id:"udp",children:[]},{value:"Unix Domain Socket",id:"unix-domain-socket",children:[]},{value:"Multi-threads",id:"multi-threads",children:[]},{value:"Load Balancing",id:"load-balancing",children:[]},{value:"SO_REUSEPORT",id:"so_reuseport",children:[]},{value:"Multiple built-in codecs for TCP stream",id:"multiple-built-in-codecs-for-tcp-stream",children:[]},{value:"Benchmarks on TechEmpower",id:"benchmarks-on-techempower",children:[]},{value:"Contrasts to the similar networking libraries",id:"contrasts-to-the-similar-networking-libraries",children:[]},{value:"On Linux (epoll)",id:"on-linux-epoll",children:[{value:"Test Environment",id:"test-environment",children:[]}]},{value:"On MacOS (kqueue)",id:"on-macos-kqueue",children:[{value:"Test Environment",id:"test-environment-1",children:[]}]}],b={rightToc:l};function s(e){var t=e.components,n=Object(o.a)(e,["components"]);return Object(i.b)("wrapper",Object(a.a)({},b,n,{components:t,mdxType:"MDXLayout"}),Object(i.b)("h1",{id:"-getting-started"},"\ud83c\udf89 Getting Started"),Object(i.b)("h2",{id:"prerequisites"},"Prerequisites"),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"gnet")," requires Go 1.9 or later."),Object(i.b)("h2",{id:"installation"},"Installation"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-powershell"}),"go get -u github.com/panjf2000/gnet\n")),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"gnet")," is available as a Go module, with ",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/golang/go/wiki/Modules"}),"Go 1.11 Modules")," support (Go 1.11+), just simply ",Object(i.b)("inlineCode",{parentName:"p"},'import "github.com/panjf2000/gnet"')," in your source code and ",Object(i.b)("inlineCode",{parentName:"p"},"go [build|run|test]")," will download the necessary dependencies automatically."),Object(i.b)("h2",{id:"usage-examples"},"Usage Examples"),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"The detailed documentation is located here: ",Object(i.b)("a",Object(a.a)({parentName:"strong"},{href:"https://pkg.go.dev/github.com/panjf2000/gnet?tab=doc"}),"docs of gnet"),", but let's pass through the brief instructions first.")),Object(i.b)("p",null,"It is easy to create a network server with ",Object(i.b)("inlineCode",{parentName:"p"},"gnet"),". All you have to do is just to make your implementation of ",Object(i.b)("inlineCode",{parentName:"p"},"gnet.EventHandler")," interface and register your event-handler functions to it, then pass it to the ",Object(i.b)("inlineCode",{parentName:"p"},"gnet.Serve")," function along with the binding address(es). Each connection is represented as a ",Object(i.b)("inlineCode",{parentName:"p"},"gnet.Conn")," interface that is passed to various events to differentiate the clients. At any point you can close a connection or shutdown the server by return a ",Object(i.b)("inlineCode",{parentName:"p"},"Close")," or ",Object(i.b)("inlineCode",{parentName:"p"},"Shutdown")," action from an event function."),Object(i.b)("p",null,"The simplest example to get you started playing with ",Object(i.b)("inlineCode",{parentName:"p"},"gnet")," would be the echo server. So here you are, a simplest echo server upon ",Object(i.b)("inlineCode",{parentName:"p"},"gnet")," that is listening on port 9000:"),Object(i.b)("h3",{id:"echo-server-without-blocking-logic"},"Echo server without blocking logic"),Object(i.b)("details",null,Object(i.b)("summary",null," Old version(<=v1.0.0-rc.4)  "),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-go"}),'package main\n\nimport (\n    "log"\n\n    "github.com/panjf2000/gnet"\n)\n\ntype echoServer struct {\n    gnet.EventServer\n}\n\nfunc (es *echoServer) React(c gnet.Conn) (out []byte, action gnet.Action) {\n    out = c.Read()\n    c.ResetBuffer()\n    return\n}\n\nfunc main() {\n    echo := new(echoServer)\n    log.Fatal(gnet.Serve(echo, "tcp://:9000", gnet.WithMulticore(true)))\n}\n'))),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-go"}),'package main\n\nimport (\n    "log"\n\n    "github.com/panjf2000/gnet"\n)\n\ntype echoServer struct {\n    gnet.EventServer\n}\n\nfunc (es *echoServer) React(frame []byte, c gnet.Conn) (out []byte, action gnet.Action) {\n    out = frame\n    return\n}\n\nfunc main() {\n    echo := new(echoServer)\n    log.Fatal(gnet.Serve(echo, "tcp://:9000", gnet.WithMulticore(true)))\n}\n')),Object(i.b)("p",null,"As you can see, this example of echo server only sets up the ",Object(i.b)("inlineCode",{parentName:"p"},"EventHandler.React")," function where you commonly write your main business code and it will be called once the server receives input data from a client. What you should know is that the input parameter: ",Object(i.b)("inlineCode",{parentName:"p"},"frame")," is a complete packet which has been decoded by the codec, as a general rule, you should implement the ",Object(i.b)("inlineCode",{parentName:"p"},"gnet")," ",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"https://pkg.go.dev/github.com/panjf2000/gnet?tab=doc#ICodec"}),"codec interface")," as the business codec to packet and unpacket TCP stream, but if you don't, your ",Object(i.b)("inlineCode",{parentName:"p"},"gnet")," server is going to work with the ",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"https://pkg.go.dev/github.com/panjf2000/gnet?tab=doc#BuiltInFrameCodec"}),"default codec")," under the acquiescence, which means all data inculding latest data and previous data in buffer will be stored in the input parameter: ",Object(i.b)("inlineCode",{parentName:"p"},"frame")," when ",Object(i.b)("inlineCode",{parentName:"p"},"EventHandler.React")," is being triggered. The output data will be then encoded and sent back to that client by assigning the ",Object(i.b)("inlineCode",{parentName:"p"},"out")," variable and returning it after your business code finish processing data(in this case, it just echo the data back)."),Object(i.b)("h3",{id:"echo-server-with-blocking-logic"},"Echo server with blocking logic"),Object(i.b)("details",null,Object(i.b)("summary",null," Old version(<=v1.0.0-rc.4)  "),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-go"}),'package main\n\nimport (\n    "log"\n    "time"\n\n    "github.com/panjf2000/gnet"\n    "github.com/panjf2000/gnet/pool/goroutine"\n)\n\ntype echoServer struct {\n    gnet.EventServer\n    pool *goroutine.Pool\n}\n\nfunc (es *echoServer) React(c gnet.Conn) (out []byte, action gnet.Action) {\n    data := append([]byte{}, c.Read()...)\n    c.ResetBuffer()\n\n    // Use ants pool to unblock the event-loop.\n    _ = es.pool.Submit(func() {\n        time.Sleep(1 * time.Second)\n        c.AsyncWrite(data)\n    })\n\n    return\n}\n\nfunc main() {\n    p := goroutine.Default()\n    defer p.Release()\n\n    echo := &echoServer{pool: p}\n    log.Fatal(gnet.Serve(echo, "tcp://:9000", gnet.WithMulticore(true)))\n}\n'))),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-go"}),'package main\n\nimport (\n    "log"\n    "time"\n\n    "github.com/panjf2000/gnet"\n    "github.com/panjf2000/gnet/pool/goroutine"\n)\n\ntype echoServer struct {\n    gnet.EventServer\n    pool *goroutine.Pool\n}\n\nfunc (es *echoServer) React(frame []byte, c gnet.Conn) (out []byte, action gnet.Action) {\n    data := append([]byte{}, frame...)\n\n    // Use ants pool to unblock the event-loop.\n    _ = es.pool.Submit(func() {\n        time.Sleep(1 * time.Second)\n        c.AsyncWrite(data)\n    })\n\n    return\n}\n\nfunc main() {\n    p := goroutine.Default()\n    defer p.Release()\n\n    echo := &echoServer{pool: p}\n    log.Fatal(gnet.Serve(echo, "tcp://:9000", gnet.WithMulticore(true)))\n}\n')),Object(i.b)("p",null,"Like I said in the \u300eMultiple Reactors + Goroutine Pool\u300fsection, if there are blocking code in your business logic, then you ought to turn them into non-blocking code in any way, for instance, you can wrap them into a goroutine, but it will result in a massive amount of goroutines if massive traffic is passing through your server so I would suggest you utilize a goroutine pool like ",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/panjf2000/ants"}),"ants")," to manage those goroutines and reduce the cost of system resources."),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"All gnet examples:")),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("p",{parentName:"li"},Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/gnet-io/gnet-examples/tree/984eed8bda54282f0d6cb2005ff48e529ae8980d"}),"Versions prior to v1.6.0"))),Object(i.b)("li",{parentName:"ul"},Object(i.b)("p",{parentName:"li"},Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/gnet-io/gnet-examples/tree/master"}),"Versions of v1.6.x"))),Object(i.b)("li",{parentName:"ul"},Object(i.b)("p",{parentName:"li"},Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/gnet-io/gnet-examples"}),"Versions of v2.x.x")))),Object(i.b)("h2",{id:"io-events"},"I/O Events"),Object(i.b)("p",null,"Current supported I/O events in ",Object(i.b)("inlineCode",{parentName:"p"},"gnet"),":"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},"EventHandler.OnInitComplete")," fires when the server has been initialized and ready to accept new connections."),Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},"EventHandler.OnOpened")," fires once a connection has been opened."),Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},"EventHandler.OnClosed")," fires after a connection has been closed."),Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},"EventHandler.React")," fires when the server receives inbound data from a socket/connection. (usually it is where you write the code of business logic)"),Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},"EventHandler.Tick")," fires right after the server starts and then fires every specified interval."),Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},"EventHandler.PreWrite")," fires just before any data has been written to client.")),Object(i.b)("h2",{id:"poll_opt-mode"},"poll_opt mode"),Object(i.b)("p",null,"By default, ",Object(i.b)("inlineCode",{parentName:"p"},"gnet")," utilizes the standard package ",Object(i.b)("inlineCode",{parentName:"p"},"golang.org/x/sys/unix")," to implement pollers with ",Object(i.b)("inlineCode",{parentName:"p"},"epoll")," or ",Object(i.b)("inlineCode",{parentName:"p"},"kqueue"),", where a HASH MAP of ",Object(i.b)("inlineCode",{parentName:"p"},"fd->conn")," is introduced to help retrieve connections by file descriptors returned from pollers, but now the user can run ",Object(i.b)("inlineCode",{parentName:"p"},"go build")," with build tags ",Object(i.b)("inlineCode",{parentName:"p"},"poll_opt"),", like this: ",Object(i.b)("inlineCode",{parentName:"p"},"go build -tags=poll_opt"),", and ",Object(i.b)("inlineCode",{parentName:"p"},"gnet")," then switch to the optimized implementations of pollers that invoke the system calls of ",Object(i.b)("inlineCode",{parentName:"p"},"epoll")," or ",Object(i.b)("inlineCode",{parentName:"p"},"kqueue")," directly and add file descriptors to the interest list along with storing the corresponding connection pointers into ",Object(i.b)("inlineCode",{parentName:"p"},"epoll_data")," or ",Object(i.b)("inlineCode",{parentName:"p"},"kevent"),", in which case ",Object(i.b)("inlineCode",{parentName:"p"},"gnet")," can get rid of the HASH MAP of ",Object(i.b)("inlineCode",{parentName:"p"},"fd->conn")," and regain each connection pointer by the conversion of ",Object(i.b)("inlineCode",{parentName:"p"},"void*")," pointer in the I/O event-looping. In theory, it ought to achieve a higher performance with this optimization."),Object(i.b)("p",null,"See ",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/panjf2000/gnet/pull/230"}),"#230")," for code details."),Object(i.b)("h2",{id:"ticker"},"Ticker"),Object(i.b)("p",null,"The ",Object(i.b)("inlineCode",{parentName:"p"},"EventHandler.Tick")," event fires ticks at a specified interval.\nThe first tick fires right after the gnet server starts up and if you intend to set up a ticker event, don't forget to pass an option: ",Object(i.b)("inlineCode",{parentName:"p"},"gnet.WithTicker(true)")," to ",Object(i.b)("inlineCode",{parentName:"p"},"gnet.Serve"),"."),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-go"}),'events.Tick = func() (delay time.Duration, action Action){\n    log.Printf("tick")\n    delay = time.Second\n    return\n}\n')),Object(i.b)("h2",{id:"udp"},"UDP"),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"gnet")," supports UDP protocol so the ",Object(i.b)("inlineCode",{parentName:"p"},"gnet.Serve")," method can bind to UDP addresses."),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"All incoming and outgoing packets will not be buffered but read and sent directly, which means all functions of ",Object(i.b)("inlineCode",{parentName:"li"},"gnet.Conn")," that manipulate the internal buffers are not available; users should use the ",Object(i.b)("inlineCode",{parentName:"li"},"frame []byte")," from the ",Object(i.b)("inlineCode",{parentName:"li"},"gnet.React(frame []byte, c gnet.Conn)")," as the UDP packet instead calling functions of ",Object(i.b)("inlineCode",{parentName:"li"},"gnet.Conn"),", like ",Object(i.b)("inlineCode",{parentName:"li"},"c.Read()"),", ",Object(i.b)("inlineCode",{parentName:"li"},"c.ResetBuffer()"),", ",Object(i.b)("inlineCode",{parentName:"li"},"c.BufferLength()")," and so on, to process data."),Object(i.b)("li",{parentName:"ul"},"The ",Object(i.b)("inlineCode",{parentName:"li"},"EventHandler.OnOpened")," and ",Object(i.b)("inlineCode",{parentName:"li"},"EventHandler.OnClosed")," events are not available for UDP sockets, only the ",Object(i.b)("inlineCode",{parentName:"li"},"React")," event."),Object(i.b)("li",{parentName:"ul"},"The UDP equivalents of  ",Object(i.b)("inlineCode",{parentName:"li"},"AsyncWrite([]byte)")," in TCP is ",Object(i.b)("inlineCode",{parentName:"li"},"SendTo([]byte)"),".")),Object(i.b)("h2",{id:"unix-domain-socket"},"Unix Domain Socket"),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"gnet"),' also supports UDS(Unix Domain Socket), just pass the UDS addresses like "unix://xxx" to the ',Object(i.b)("inlineCode",{parentName:"p"},"gnet.Serve")," method and you could play with it."),Object(i.b)("p",null,"It is nothing different from making use of TCP when doing stuff with UDS, so the ",Object(i.b)("inlineCode",{parentName:"p"},"gnet")," UDS servers are able to leverage all event functions which are available under TCP protocol."),Object(i.b)("h2",{id:"multi-threads"},"Multi-threads"),Object(i.b)("p",null,"The ",Object(i.b)("inlineCode",{parentName:"p"},"gnet.WithMulticore(true)")," indicates whether the server will be effectively created with multi-cores, if so, then you must take care of synchronizing memory between all event callbacks, otherwise, it will run the server with a single thread. The number of threads in the server will be automatically assigned to the value of ",Object(i.b)("inlineCode",{parentName:"p"},"runtime.NumCPU()"),"."),Object(i.b)("h2",{id:"load-balancing"},"Load Balancing"),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"gnet")," currently supports three load balancing algorithms: ",Object(i.b)("inlineCode",{parentName:"p"},"Round-Robin"),", ",Object(i.b)("inlineCode",{parentName:"p"},"Source-Addr-Hash")," and ",Object(i.b)("inlineCode",{parentName:"p"},"Least-Connections"),", you are able to decide which algorithm to use by passing the functional option ",Object(i.b)("inlineCode",{parentName:"p"},"LB")," (RoundRobin/LeastConnections/SourceAddrHash) to ",Object(i.b)("inlineCode",{parentName:"p"},"gnet.Serve"),"."),Object(i.b)("p",null,"If the load balancing algorithm is not specified explicitly, ",Object(i.b)("inlineCode",{parentName:"p"},"gnet")," will use ",Object(i.b)("inlineCode",{parentName:"p"},"Round-Robin")," by default."),Object(i.b)("h2",{id:"so_reuseport"},"SO_REUSEPORT"),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"gnet")," server is able to utilize the ",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"https://lwn.net/Articles/542629/"}),"SO_REUSEPORT")," option which allows multiple sockets on the same host to bind to the same port and the OS kernel takes care of the load balancing for you, it wakes one socket per ",Object(i.b)("inlineCode",{parentName:"p"},"connect")," event coming to resolved the ",Object(i.b)("inlineCode",{parentName:"p"},"thundering herd"),"."),Object(i.b)("p",null,"By default, ",Object(i.b)("inlineCode",{parentName:"p"},"gnet")," is not going to be haunted by the ",Object(i.b)("inlineCode",{parentName:"p"},"thundering herd")," under its networking model:\u300emultiple reactors\u300fwhich gets only ",Object(i.b)("strong",{parentName:"p"},"one"),' main reactor to listen on "address:port" and accept new sockets. So this ',Object(i.b)("inlineCode",{parentName:"p"},"SO_REUSEPORT")," option is trivial in ",Object(i.b)("inlineCode",{parentName:"p"},"gnet")," but note that it will fall back to the old networking model of ",Object(i.b)("inlineCode",{parentName:"p"},"evio")," when you enable the ",Object(i.b)("inlineCode",{parentName:"p"},"SO_REUSEPORT")," option."),Object(i.b)("p",null,"Just use functional options to set up ",Object(i.b)("inlineCode",{parentName:"p"},"SO_REUSEPORT")," and you can enjoy this feature:"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-go"}),'gnet.Serve(events, "tcp://:9000", gnet.WithMulticore(true), gnet.WithReusePort(true)))\n')),Object(i.b)("h2",{id:"multiple-built-in-codecs-for-tcp-stream"},"Multiple built-in codecs for TCP stream"),Object(i.b)("p",null,"There are multiple built-in codecs in ",Object(i.b)("inlineCode",{parentName:"p"},"gnet")," which allow you to encode/decode frames into/from TCP stream."),Object(i.b)("p",null,"So far ",Object(i.b)("inlineCode",{parentName:"p"},"gnet")," has four kinds of built-in codecs: LineBasedFrameCodec, DelimiterBasedFrameCodec, FixedLengthFrameCodec and LengthFieldBasedFrameCodec, which generally meets most scenarios, but still ",Object(i.b)("inlineCode",{parentName:"p"},"gnet")," allows users to customize their own codecs in their ",Object(i.b)("inlineCode",{parentName:"p"},"gnet")," servers by implementing the interface ",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"https://pkg.go.dev/github.com/panjf2000/gnet?tab=doc#ICodec"}),"gnet.ICodec")," and replacing the default codec in ",Object(i.b)("inlineCode",{parentName:"p"},"gnet")," with customized codec via functional options."),Object(i.b)("p",null,"Here is an ",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/gnet-io/gnet-examples/tree/master/examples/codec"}),"example")," with codec, showing you how to leverage codec to encode/decode network frames into/from TCP stream."),Object(i.b)("h1",{id:"-performance"},"\ud83d\udcca Performance"),Object(i.b)("h2",{id:"benchmarks-on-techempower"},"Benchmarks on TechEmpower"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),'# Hardware Environment\n* 28 HT Cores Intel(R) Xeon(R) Gold 5120 CPU @ 3.20GHz\n* 32GB RAM\n* Dedicated Cisco 10-gigabit Ethernet switch\n* Debian 12 "bookworm"\n* Go1.19.x linux/amd64\n')),Object(i.b)("p",null,Object(i.b)("img",Object(a.a)({parentName:"p"},{src:"https://raw.githubusercontent.com/panjf2000/illustrations/master/benchmark/techempower-plaintext-top50-light.jpg",alt:null}))),Object(i.b)("p",null,"This is a leaderboard of the top ",Object(i.b)("strong",{parentName:"p"},Object(i.b)("em",{parentName:"strong"},"50"))," out of ",Object(i.b)("strong",{parentName:"p"},Object(i.b)("em",{parentName:"strong"},"486"))," frameworks that encompass various programming languages worldwide, in which ",Object(i.b)("inlineCode",{parentName:"p"},"gnet")," is ranked ",Object(i.b)("strong",{parentName:"p"},Object(i.b)("em",{parentName:"strong"},"first")),"."),Object(i.b)("p",null,Object(i.b)("img",Object(a.a)({parentName:"p"},{src:"https://raw.githubusercontent.com/panjf2000/illustrations/master/benchmark/techempower-plaintext-topN-go-light.png",alt:null}))),Object(i.b)("p",null,"This is the full framework ranking of Go and ",Object(i.b)("inlineCode",{parentName:"p"},"gnet")," tops all the other frameworks, which makes ",Object(i.b)("inlineCode",{parentName:"p"},"gnet")," the ",Object(i.b)("strong",{parentName:"p"},Object(i.b)("em",{parentName:"strong"},"fastest"))," networking framework in Go."),Object(i.b)("p",null,"To see the full ranking list, visit ",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"https://www.techempower.com/benchmarks/#hw=ph&test=plaintext&section=data-r22"}),"TechEmpower Benchmark ",Object(i.b)("strong",{parentName:"a"},"Round 22")),"."),Object(i.b)("h2",{id:"contrasts-to-the-similar-networking-libraries"},"Contrasts to the similar networking libraries"),Object(i.b)("h2",{id:"on-linux-epoll"},"On Linux (epoll)"),Object(i.b)("h3",{id:"test-environment"},"Test Environment"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-powershell"}),"# Machine information\n        OS : Ubuntu 20.04/x86_64\n       CPU : 8 CPU cores, AMD EPYC 7K62 48-Core Processor\n    Memory : 16.0 GiB\n\n# Go version and settings\nGo Version : go1.17.2 linux/amd64\nGOMAXPROCS : 8\n\n# Benchmark parameters\nTCP connections : 1000/2000/5000/10000\nPacket size     : 512/1024/2048/4096/8192/16384/32768/65536 bytes\nTest duration   : 15s\n")),Object(i.b)("h4",{id:"echo-benchmark"},Object(i.b)("a",Object(a.a)({parentName:"h4"},{href:"https://github.com/gnet-io/gnet-benchmarks"}),"Echo benchmark")),Object(i.b)("p",null,Object(i.b)("img",Object(a.a)({parentName:"p"},{src:"https://github.com/panjf2000/gnet_benchmarks/raw/master/results/echo_conn_linux.png",alt:null}))),Object(i.b)("p",null,Object(i.b)("img",Object(a.a)({parentName:"p"},{src:"https://github.com/panjf2000/gnet_benchmarks/raw/master/results/echo_packet_linux.png",alt:null}))),Object(i.b)("h2",{id:"on-macos-kqueue"},"On MacOS (kqueue)"),Object(i.b)("h3",{id:"test-environment-1"},"Test Environment"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-powershell"}),"# Machine information\n        OS : MacOS Big Sur/x86_64\n       CPU : 6 CPU cores, Intel(R) Core(TM) i7-9750H CPU @ 2.60GHz\n    Memory : 16.0 GiB\n\n# Go version and settings\nGo Version : go1.16.5 darwin/amd64\nGOMAXPROCS : 12\n\n# Benchmark parameters\nTCP connections : 300/400/500/600/700\nPacket size     : 512/1024/2048/4096/8192 bytes\nTest duration   : 15s\n")),Object(i.b)("h4",{id:"echo-benchmark-1"},Object(i.b)("a",Object(a.a)({parentName:"h4"},{href:"https://github.com/gnet-io/gnet-benchmarks"}),"Echo benchmark")),Object(i.b)("p",null,Object(i.b)("img",Object(a.a)({parentName:"p"},{src:"https://github.com/panjf2000/gnet_benchmarks/raw/master/results/echo_conn_macos.png",alt:null}))),Object(i.b)("p",null,Object(i.b)("img",Object(a.a)({parentName:"p"},{src:"https://github.com/panjf2000/gnet_benchmarks/raw/master/results/echo_packet_macos.png",alt:null}))),Object(i.b)("h1",{id:"\ufe0f-license"},"\ufe0f\ud83d\udea8 License"),Object(i.b)("p",null,"Source code in ",Object(i.b)("inlineCode",{parentName:"p"},"gnet")," is available under the ",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/panjf2000/gnet/blob/master/LICENSE"}),"MIT License"),"."),Object(i.b)("h1",{id:"-contributors"},"\ud83d\udc4f Contributors"),Object(i.b)("p",null,"Please read the ",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/panjf2000/gnet/blob/master/CONTRIBUTING.md"}),"Contributing Guidelines")," before opening a PR and thank you to all the developers who already made contributions to ",Object(i.b)("inlineCode",{parentName:"p"},"gnet"),"!"),Object(i.b)("p",null,Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/panjf2000/gnet/graphs/contributors"}),Object(i.b)("img",Object(a.a)({parentName:"a"},{src:"https://opencollective.com/gnet/contributors.svg?width=890&button=false",alt:null})))),Object(i.b)("h1",{id:"-acknowledgments"},"\ud83d\ude4f Acknowledgments"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("a",Object(a.a)({parentName:"li"},{href:"https://github.com/tidwall/evio"}),"evio")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("a",Object(a.a)({parentName:"li"},{href:"https://github.com/netty/netty"}),"netty")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("a",Object(a.a)({parentName:"li"},{href:"https://github.com/panjf2000/ants"}),"ants")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("a",Object(a.a)({parentName:"li"},{href:"https://github.com/kavu/go_reuseport"}),"go_reuseport")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("a",Object(a.a)({parentName:"li"},{href:"https://github.com/valyala/bytebufferpool"}),"bytebufferpool")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("a",Object(a.a)({parentName:"li"},{href:"https://github.com/smallnest/goframe"}),"goframe")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("a",Object(a.a)({parentName:"li"},{href:"https://github.com/smallnest/ringbuffer"}),"ringbuffer"))),Object(i.b)("h1",{id:"-relevant-articles"},"\u2693 Relevant Articles"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("a",Object(a.a)({parentName:"li"},{href:"https://www.freecodecamp.org/news/million-websockets-and-go-cc58418460bb/"}),"A Million WebSockets and Go")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("a",Object(a.a)({parentName:"li"},{href:"https://speakerdeck.com/eranyanay/going-infinite-handling-1m-websockets-connections-in-go"}),"Going Infinite, handling 1M websockets connections in Go")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("a",Object(a.a)({parentName:"li"},{href:"https://strikefreedom.top/go-netpoll-io-multiplexing-reactor"}),"Go netpoller \u539f\u751f\u7f51\u7edc\u6a21\u578b\u4e4b\u6e90\u7801\u5168\u9762\u63ed\u79d8")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("a",Object(a.a)({parentName:"li"},{href:"https://strikefreedom.top/go-event-loop-networking-library-gnet"}),"gnet: \u4e00\u4e2a\u8f7b\u91cf\u7ea7\u4e14\u9ad8\u6027\u80fd\u7684 Golang \u7f51\u7edc\u5e93")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("a",Object(a.a)({parentName:"li"},{href:"https://strikefreedom.top/releasing-gnet-v1-with-techempower"}),"\u6700\u5feb\u7684 Go \u7f51\u7edc\u6846\u67b6 gnet \u6765\u5566\uff01"))),Object(i.b)("h1",{id:"-use-cases"},"\ud83c\udfa1 Use cases"),Object(i.b)("p",null,"The following companies/organizations use ",Object(i.b)("inlineCode",{parentName:"p"},"gnet")," as the underlying network service in production."),Object(i.b)("a",{href:"https://www.tencent.com"},Object(i.b)("img",{src:"https://res.strikefreedom.top/static_res/logos/tencent_logo.png",width:"250",align:"middle"})),"\xa0\xa0",Object(i.b)("a",{href:"https://www.iqiyi.com",target:"_blank"},Object(i.b)("img",{src:"https://res.strikefreedom.top/static_res/logos/iqiyi-logo.png",width:"200",align:"middle"})),"\xa0\xa0",Object(i.b)("a",{href:"https://www.mi.com",target:"_blank"},Object(i.b)("img",{src:"https://res.strikefreedom.top/static_res/logos/mi-logo.png",width:"150",align:"middle"})),"\xa0\xa0",Object(i.b)("a",{href:"https://www.360.com",target:"_blank"},Object(i.b)("img",{src:"https://res.strikefreedom.top/static_res/logos/360-logo.png",width:"200",align:"middle"})),"\xa0\xa0",Object(i.b)("a",{href:"https://tieba.baidu.com/",target:"_blank"},Object(i.b)("img",{src:"https://res.strikefreedom.top/static_res/logos/baidu-tieba-logo.png",width:"200",align:"middle"})),"\xa0\xa0",Object(i.b)("a",{href:"https://game.qq.com/",target:"_blank"},Object(i.b)("img",{src:"https://res.strikefreedom.top/static_res/logos/tencent-games-logo.png",width:"200",align:"middle"})),Object(i.b)("p",null,"If your projects are also using ",Object(i.b)("inlineCode",{parentName:"p"},"gnet"),", feel free to open a ",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/panjf2000/gnet/pulls"}),"pull request")," refreshing this list of use cases."),Object(i.b)("h1",{id:"-backers"},"\ud83d\udcb0 Backers"),Object(i.b)("p",null,"Support us with a monthly donation and help us continue our activities."),Object(i.b)("a",{href:"https://opencollective.com/gnet#backers",target:"_blank"},Object(i.b)("img",{src:"https://opencollective.com/gnet/backers.svg"})),Object(i.b)("h1",{id:"-sponsors"},"\ud83d\udc8e Sponsors"),Object(i.b)("p",null,"Become a bronze sponsor with a monthly donation of $10 and get your logo on our README on Github."),Object(i.b)("a",{href:"https://opencollective.com/gnet#sponsors",target:"_blank"},Object(i.b)("img",{src:"https://opencollective.com/gnet/sponsors.svg"})),Object(i.b)("h1",{id:"\ufe0f-buy-me-a-coffee"},"\u2615\ufe0f Buy me a coffee"),Object(i.b)("blockquote",null,Object(i.b)("p",{parentName:"blockquote"},"Please be sure to leave your name, Github account or other social media accounts when you donate by the following means so that I can add it to the list of donors as a token of my appreciation.")),Object(i.b)("table",null,Object(i.b)("tr",null,Object(i.b)("td",null,Object(i.b)("img",{src:"https://raw.githubusercontent.com/panjf2000/illustrations/master/payments/WeChatPay.JPG",width:"250"})),Object(i.b)("td",null,Object(i.b)("img",{src:"https://raw.githubusercontent.com/panjf2000/illustrations/master/payments/AliPay.JPG",width:"250"})),Object(i.b)("td",null,Object(i.b)("a",{href:"https://www.paypal.me/R136a1X",target:"_blank"},Object(i.b)("img",{src:"https://raw.githubusercontent.com/panjf2000/illustrations/master/payments/PayPal.JPG",width:"250"}))))),Object(i.b)("h1",{id:"-patrons"},"\ud83d\udcb4 Patrons"),Object(i.b)("a",{target:"_blank",href:"https://github.com/patrick-othmer"},Object(i.b)("img",{src:"https://avatars1.githubusercontent.com/u/8964313",width:"100",alt:"Patrick Othmer"})),"\xa0\xa0",Object(i.b)("a",{target:"_blank",href:"https://github.com/panjf2000/gnet"},Object(i.b)("img",{src:"https://avatars2.githubusercontent.com/u/50285334",width:"100",alt:"Jimmy"})),"\xa0\xa0",Object(i.b)("a",{target:"_blank",href:"https://github.com/cafra"},Object(i.b)("img",{src:"https://avatars0.githubusercontent.com/u/13758306",width:"100",alt:"ChenZhen"})),"\xa0\xa0",Object(i.b)("a",{target:"_blank",href:"https://github.com/yangwenmai"},Object(i.b)("img",{src:"https://avatars0.githubusercontent.com/u/1710912",width:"100",alt:"Mai Yang"})),"\xa0\xa0",Object(i.b)("a",{target:"_blank",href:"https://github.com/BeijingWks"},Object(i.b)("img",{src:"https://avatars3.githubusercontent.com/u/33656339",width:"100",alt:"\u738b\u5f00\u5e05"})),"\xa0\xa0",Object(i.b)("a",{target:"_blank",href:"https://github.com/refs"},Object(i.b)("img",{src:"https://avatars3.githubusercontent.com/u/6905948",width:"100",alt:"Unger Alejandro"})),"\xa0\xa0",Object(i.b)("a",{target:"_blank",href:"https://github.com/Swaggadan"},Object(i.b)("img",{src:"https://avatars.githubusercontent.com/u/137142",width:"100",alt:"Swaggadan"})),"\xa0",Object(i.b)("a",{target:"_blank",href:"https://github.com/Wuvist"},Object(i.b)("img",{src:"https://avatars.githubusercontent.com/u/657796",width:"100",alt:"Weng Wei"})),Object(i.b)("h1",{id:"-jetbrains-os-licenses"},"\ud83d\udd11 JetBrains OS licenses"),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"gnet")," had been being developed with ",Object(i.b)("inlineCode",{parentName:"p"},"GoLand")," IDE under the ",Object(i.b)("strong",{parentName:"p"},"free JetBrains Open Source license(s)")," granted by JetBrains s.r.o., hence I would like to express my thanks here."),Object(i.b)("a",{href:"https://www.jetbrains.com/?from=gnet",target:"_blank"},Object(i.b)("img",{src:"https://raw.githubusercontent.com/panjf2000/illustrations/master/jetbrains/jetbrains-variant-4.png",width:"250",align:"middle"})),Object(i.b)("h1",{id:"-sponsorship"},"\ud83d\udd0b Sponsorship"),Object(i.b)("p",null,Object(i.b)("h3",null,"This project is supported by:"),Object(i.b)("a",{href:"https://www.digitalocean.com/"},Object(i.b)("img",{src:"https://opensource.nyc3.cdn.digitaloceanspaces.com/attribution/assets/SVG/DO_Logo_horizontal_blue.svg",width:"201px"}))))}s.isMDXComponent=!0},246:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return m}));var a=n(0),o=n.n(a);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var b=o.a.createContext({}),s=function(e){var t=o.a.useContext(b),n=t;return e&&(n="function"==typeof e?e(t):c({},t,{},e)),n},p=function(e){var t=s(e.components);return o.a.createElement(b.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return o.a.createElement(o.a.Fragment,{},t)}},h=Object(a.forwardRef)((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,r=e.parentName,b=l(e,["components","mdxType","originalType","parentName"]),p=s(n),h=a,m=p["".concat(r,".").concat(h)]||p[h]||u[h]||i;return n?o.a.createElement(m,c({ref:t},b,{components:n})):o.a.createElement(m,c({ref:t},b))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,r=new Array(i);r[0]=h;var c={};for(var l in t)hasOwnProperty.call(t,l)&&(c[l]=t[l]);c.originalType=e,c.mdxType="string"==typeof e?e:a,r[1]=c;for(var b=2;b<i;b++)r[b]=n[b];return o.a.createElement.apply(null,r)}return o.a.createElement.apply(null,n)}h.displayName="MDXCreateElement"}}]);